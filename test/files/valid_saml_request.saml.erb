<samlp:AuthnRequest
  AssertionConsumerServiceURL='<%= settings.target_url %>'
  Destination='<%= File.join(settings.root_url, 'identify/new') %>'
  ID='<%= '_' + SecureRandom.uuid %>'
  IssueInstant='<%= Time.now.utc.iso8601 %>'
  Version='2.0'
  xmlns:samlp='urn:oasis:names:tc:SAML:2.0:protocol'
  xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"
>
  <saml:Issuer xmlns:saml='urn:oasis:names:tc:SAML:2.0:assertion'>
    <%= settings.root_url %>
  </saml:Issuer>
  <samlp:NameIDPolicy
    AllowCreate='true'
    Format='urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress'
    xmlns:samlp='urn:oasis:names:tc:SAML:2.0:protocol'
  />
  <samlp:RequestedAuthnContext
    Comparison='exact'
    xmlns:samlp='urn:oasis:names:tc:SAML:2.0:protocol'
  >
    <saml:AuthnContextClassRef
      xmlns:saml='urn:oasis:names:tc:SAML:2.0:assertion'
    >
      urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport
    </saml:AuthnContextClassRef>
  </samlp:RequestedAuthnContext>
</samlp:AuthnRequest>
